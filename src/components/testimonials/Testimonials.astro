---
import testimonials from "../../data/testimonials";
import TestimonialCard from "./TestimonialCard.astro";
---

<section class="testimonials">
	<div class="testimonials__inner container">
		<div class="testimonials__head">
			<div class="testimonials__title-block">
				<span class="testimonials__tag section-tag section-tag--big-space">Testimonials</span>
				<h2 class="testimonials__title h3">People all over the world use banko.</h2>
			</div>
			<div class="testimonials__rating">
				<span class="testimonials__rating-text">Rated <span class="testimonials__rating-value">4.8/5</span> from over 1000 users</span>
			</div>
		</div>
		<div class="testimonials__wrapper">
			<ul role="list" aria-label="testimonials list" class="testimonials__list">
				<div class="grid-sizer"></div>
				{testimonials.map(testimonial => (
					<li class="testimonials__list-item">
						<TestimonialCard testimonial = {testimonial}/>
					</li>
				))}
			</ul>
		</div>
		<div class="testimonials__dots">
			{testimonials.map(testimonial => (
					testimonial && <button class="slider-dot"></button>
				))}
		</div>
	</div>
</section>

<script>
	import Masonry from 'masonry-layout';
	import imagesLoaded from 'imagesloaded';
	import slider from '../../utilities/slider.js';

	slider('.testimonials__list', '.testimonials__list-item', '.slider-dot', '.testimonials__inner', 'slider-dot--active');

	window.onload = function() {
		var grid = document.querySelector('.testimonials__list');
		var msnry = new Masonry( grid, {
			itemSelector: '.testimonials__list-item',
			columnWidth: '.grid-sizer',
			percentPosition: true,
			horizontalOrder: true,
			gutter: 31
		});

		imagesLoaded( grid ).on( 'progress', function() {
			msnry.layout();
		});
	};
</script>